{
	"version": 3,
	"configurePresets": [
		{
			"name": "default",
			"displayName": "Debug",
			"description": "使用 Debug 级别的构建配置，包含调试符号和运行时检查",
			"generator": "Ninja",
			"binaryDir": "${sourceDir}/build/debug",
			"installDir": "${sourceDir}/install/debug",
			"cacheVariables": {
				"CMAKE_BUILD_TYPE": "Debug",
				"CMAKE_EXPORT_COMPILE_COMMANDS": "ON",
				"CMAKE_COLOR_DIAGNOSTICS": "ON",
				"CMAKE_CXX_STANDARD": "20",
				"CMAKE_CXX_STANDARD_REQUIRED": "ON",
				"CMAKE_CXX_EXTENSIONS": "OFF",
				"CMAKE_C_STANDARD": "17",
				"CMAKE_C_STANDARD_REQUIRED": "ON",
				"CMAKE_C_EXTENSIONS": "OFF",
				"CMAKE_CXX_FLAGS_DEBUG": "-g -O0 -fno-omit-frame-pointer -fsanitize=address,undefined",
				"CMAKE_C_FLAGS_DEBUG": "-g -O0 -fno-omit-frame-pointer -fsanitize=address,undefined",
				"CMAKE_VERBOSE_MAKEFILE": "ON",
				"BUILD_SHARED_LIBS": "ON",
				"BUILD_TESTING": "ON",
				"PROJECT_ROOT_DIR": "${sourceDir}",
				"EXTERNAL_LIBS_DIR": "${sourceDir}/external_libs",
				"CMAKE_INSTALL_PREFIX": "${sourceDir}/bin",
				"CMAKE_RUNTIME_OUTPUT_DIRECTORY": "${sourceDir}/build/debug/bin",
				"CMAKE_ARCHIVE_OUTPUT_DIRECTORY": "${sourceDir}/build/debug/lib",
				"CMAKE_LIBRARY_OUTPUT_DIRECTORY": "${sourceDir}/build/debug/lib",
				"CMAKE_RUNTIME_OUTPUT_DIRECTORY_DEBUG": "${sourceDir}/build/debug/bin",
				"CMAKE_LIBRARY_OUTPUT_DIRECTORY_DEBUG": "${sourceDir}/build/debug/bin",
				"CMAKE_ARCHIVE_OUTPUT_DIRECTORY_DEBUG": "${sourceDir}/build/debug/lib"
			},
			"warnings": {
				"dev": true,
				"deprecated": true,
				"uninitialized": true,
				"unusedCli": true,
				"systemVars": false
			},
			"environment": {
				"CTEST_OUTPUT_ON_FAILURE": "1",
				"VERBOSE": "1"
			}
		},
		{
			"name": "release",
			"displayName": "Release",
			"description": "使用 Release 级别的构建配置，优化性能和体积",
			"inherits": "default",
			"binaryDir": "${sourceDir}/build/release",
			"installDir": "${sourceDir}/install/release",
			"cacheVariables": {
				"CMAKE_BUILD_TYPE": "Release",
				"CMAKE_EXPORT_COMPILE_COMMANDS": "OFF",
				"CMAKE_CXX_FLAGS_RELEASE": "-O3 -DNDEBUG -march=native -flto -ffunction-sections -fdata-sections",
				"CMAKE_C_FLAGS_RELEASE": "-O3 -DNDEBUG -march=native -flto -ffunction-sections -fdata-sections",
				"CMAKE_EXE_LINKER_FLAGS_RELEASE": "-s -Wl,--gc-sections -flto",
				"CMAKE_SHARED_LINKER_FLAGS_RELEASE": "-s -Wl,--gc-sections -flto",
				"CMAKE_VERBOSE_MAKEFILE": "OFF",
				"CMAKE_INSTALL_PREFIX": "${sourceDir}/bin",
				"CMAKE_INTERPROCEDURAL_OPTIMIZATION": "ON",
				"BUILD_TESTING": "OFF",
				"CMAKE_INSTALL_DO_STRIP": "ON",
				"CMAKE_RUNTIME_OUTPUT_DIRECTORY": "${sourceDir}/build/release/bin",
				"CMAKE_ARCHIVE_OUTPUT_DIRECTORY": "${sourceDir}/build/release/lib",
				"CMAKE_LIBRARY_OUTPUT_DIRECTORY": "${sourceDir}/build/release/lib",
				"CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELEASE": "${sourceDir}/build/release/bin",
				"CMAKE_LIBRARY_OUTPUT_DIRECTORY_RELEASE": "${sourceDir}/build/release/bin",
				"CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELEASE": "${sourceDir}/build/release/lib"
			},
			"warnings": {
				"dev": false,
				"deprecated": false,
				"uninitialized": false,
				"unusedCli": false,
				"systemVars": false
			},
			"environment": {
				"CTEST_OUTPUT_ON_FAILURE": "0",
				"VERBOSE": "0"
			}
		},
		{
			"name": "relwithdebinfo",
			"displayName": "RelWithDebInfo",
			"description": "Release 构建但保留调试信息",
			"inherits": "default",
			"binaryDir": "${sourceDir}/build/relwithdebinfo",
			"installDir": "${sourceDir}/install/relwithdebinfo",
			"cacheVariables": {
				"CMAKE_BUILD_TYPE": "RelWithDebInfo",
				"CMAKE_CXX_FLAGS_RELWITHDEBINFO": "-O2 -g -DNDEBUG",
				"CMAKE_C_FLAGS_RELWITHDEBINFO": "-O2 -g -DNDEBUG",
				"CMAKE_INSTALL_PREFIX": "${sourceDir}/bin",
				"BUILD_TESTING": "ON",
				"CMAKE_RUNTIME_OUTPUT_DIRECTORY": "${sourceDir}/build/relwithdebinfo/bin",
				"CMAKE_LIBRARY_OUTPUT_DIRECTORY": "${sourceDir}/build/relwithdebinfo/bin",
				"CMAKE_ARCHIVE_OUTPUT_DIRECTORY": "${sourceDir}/build/relwithdebinfo/lib",
				"CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELWITHDEBINFO": "${sourceDir}/build/relwithdebinfo/bin",
				"CMAKE_LIBRARY_OUTPUT_DIRECTORY_RELWITHDEBINFO": "${sourceDir}/build/relwithdebinfo/bin",
				"CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELWITHDEBINFO": "${sourceDir}/build/relwithdebinfo/lib"
			}
		}
	],
	"buildPresets": [
		{
			"name": "default",
			"displayName": "Build Debug",
			"configurePreset": "default",
			"configuration": "Debug",
			"jobs": 4,
			"targets": ["all"],
			"verbose": true
		},
		{
			"name": "release",
			"displayName": "Build Release",
			"configurePreset": "release",
			"configuration": "Release",
			"jobs": 8,
			"targets": ["all"],
			"verbose": false,
			"cleanFirst": true
		},
		{
			"name": "relwithdebinfo",
			"displayName": "Build RelWithDebInfo",
			"configurePreset": "relwithdebinfo",
			"configuration": "RelWithDebInfo",
			"jobs": 6
		},
		{
			"name": "install-debug",
			"displayName": "Install Debug to bin",
			"configurePreset": "default",
			"configuration": "Debug",
			"targets": ["install"]
		},
		{
			"name": "install-release",
			"displayName": "Install Release to bin",
			"configurePreset": "release",
			"configuration": "Release",
			"targets": ["install"]
		},
		{
			"name": "debug-and-install",
			"displayName": "Build Debug and Copy to bin",
			"configurePreset": "default",
			"configuration": "Debug",
			"targets": ["all", "install"]
		},
		{
			"name": "release-and-install",
			"displayName": "Build Release and Copy to bin",
			"configurePreset": "release",
			"configuration": "Release",
			"targets": ["all", "install"]
		}
	],
	"testPresets": [
		{
			"name": "default",
			"displayName": "Test Debug",
			"configurePreset": "default",
			"configuration": "Debug",
			"output": {
				"outputOnFailure": true,
				"verbosity": "verbose"
			},
			"execution": {
				"noTestsAction": "error",
				"stopOnFailure": false
			}
		},
		{
			"name": "release",
			"displayName": "Test Release",
			"configurePreset": "release",
			"configuration": "Release",
			"output": {
				"outputOnFailure": true,
				"verbosity": "default"
			}
		}
	]
}
